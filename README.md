# 建筑物损伤诊断系统

基于深度学习的建筑物损伤诊断系统，使用 PyTorch 实现，能够从 InSAR 数据中识别和定位建筑物损伤。
<img width="3353" height="1874" alt="38210fa8-43aa-49b3-98a6-dcbef30ee32b" src="https://github.com/user-attachments/assets/412f929d-e4ea-486b-985f-119e2b131d27" />

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![PyTorch](https://img.shields.io/badge/PyTorch-1.9%2B-red)
![License](https://img.shields.io/badge/License-MIT-green)

# 功能特点
利用已标注的“有限元仿真数据 + 实际案例数据”，学习并建立从 “InSAR形变特征” 到 “结构损伤状态” 的复杂非线性映射关系，生成一个高性能、高泛化能力的可部署模型。该模块整合了数据预处理、网络构建、损失计算、优化迭代和模型保存的全过程，其内部工作流与子功能如下：
数据准备与预处理子模块：读取训练CSV文件，为模型学习准备高质量、标准化的数据。
解析与清洗：加载原始数据，检查格式有效性，随机划分20%的数据作为验证集，80%的数据用于训练。
特征解耦：将混合的序列拆解为独立的距离序列 (d_vec) 和 斜率序列 (s_vec)。
统计量计算：计算并保存训练集上所有距离、斜率、跨度、宽度及损伤程度的均值 (μ) 和标准差 (σ)。这是标准化和未来推理的基准。
标准化：使用上述计算的μ和σ对所有特征进行标准化，消除量纲，加速模型收敛。
模型构建与训练子模块：定义网络结构，并通过迭代优化调整网络参数（权重和偏置）。
网络架构初始化：构建双流一维卷积网络。该网络能分别从距离和斜率序列中提取特征，并与结构几何特征融合，最后通过两个并行的“头”进行预测。
多任务损失计算：在每轮训练中，同时计算：分类损失 (CrossEntropyLoss)：衡量预测损伤位置（象限）与真实标签的差异；回归损失 (MSELoss)：衡量预测损伤程度与真实值的差异；联合损失：将上述损失加权求和（总损失 = 分类损失 + 2.0 * 回归损失）作为总的优化目标。
反向传播与优化：使用AdamW优化器，根据总损失计算梯度并更新网络参数，使预测结果不断逼近真实值。
学习率动态调整：使用ReduceLROnPlateau策略，在验证损失停滞时自动降低学习率，以精细调优模型。
模型验证与保存子模块：监控训练过程，防止过拟合，并保存最佳模型。
验证集评估：在每个训练周期（Epoch）结束后，在未参与训练的验证集数据上评估模型性能，计算验证损失、定位准确率等指标。
早停机制 (Early Stopping)：若验证损失连续多个周期不再下降，则自动终止训练，避免模型过度记忆训练数据而丧失泛化能力。
最佳模型检查点：持续监控验证指标，始终在内存和磁盘中保存表现最好的模型版本。
模型序列化：将最终的最佳模型权重、优化器状态、关键的标准化参数（μ, σ）等全部保存到一个.pt文件中，供推理模块直接调用。同时生成训练日志文件，用于性能分析和可视化。
4.损伤诊断推理模块
利用训练模块保存的成熟模型，对新的、未标注的现场InSAR观测数据（建筑物）进行自动化的损伤诊断，输出定位和定量结果。该模块是训练成果的应用，强调自动化、保真性和工程输出，其内部工作流与子功能如下：
数据预处理子模块：确保推理数据的处理方式与训练时完全一致，避免因处理流程不一致而导致性能下降。
加载标准化参数：从训练好的模型文件(.pt)中读取并加载之前保存的均值(μ)和标准差(σ)。这是至关重要的一步，保证了训练和推理环境的一致性。
特征解耦与标准化：对待推理的CSV数据中的每一条样本，进行与训练时相同的解耦和标准化操作。
模型前向推理子模块：执行高效、快速的前向计算，得到预测结果。
加载模型：将训练模块保存的最佳模型权重加载到网络中。
设置为评估模式：调用model.eval()，关闭Dropout等仅在训练中使用的层，确保输出的确定性。
禁用梯度计算：使用torch.no_grad()上下文，大幅减少内存消耗并加速计算。
前向传播：将预处理好的数据输入模型，得到原始的预测输出。
结果后处理与输出子模块：将模型的原始输出转化为易于理解和使用的工程结论。
反标准化：将模型预测的标准化损伤程度，利用保存的sev_mean和sev_std进行反变换：预测真值 = 预测值 * σ_sev + μ_sev，得到实际的、有物理意义的损伤程度值。
生成置信度：对象限预测的logits执行Softmax操作，得到每个象限的概率，并将最大概率作为该预测的置信度。
结果格式化与输出：
JSON输出：将每个建筑物的预测结果（象限编号、损伤程度、置信度）生成结构化的JSON文件，便于其他软件系统调用和集成。
CSV输出：也可生成CSV表格，便于人工查阅和简单分析。
批量处理：该模块设计为可对大量建筑物数据进行批量推理，实现城市级别的快速筛查。
- **多任务学习**: 同时预测损伤位置（象限）和损伤程度
- **自适应架构**: 适用于不同尺寸和形状的建筑物
- **完整工具链**: 训练、评估、推理和可视化一体化
- **高性能**: 支持 GPU 加速和批量处理
- **易用性**: 简单的命令行接口和清晰的文档


双流一维卷积特征融合网络（BSDINet）：网络采用双流设计，使用两个并行的1D-CNN分支分别萃取距离和斜率序列的深层空间模式。其后通过融合层（Fusion Layer）将抽象特征与建筑物的几何标量特征（跨度、宽度）进行拼接，共同输入至后续决策层。这种设计允许网络有针对性地学习不同物理意义的特征，提升了特征表达的能力。
多任务联合学习与优化：软件的核心算法采用多任务学习（MTL） 范式。网络共享底部的特征提取器，在上层分叉为两个任务特定的头：一个用于损伤象限分类（Softmax输出），一个用于损伤程度回归（线性输出）。通过动态加权的联合损失函数（如 Loss = Loss_classification + λ * Loss_regression）进行协同优化。这种范式不仅提高了计算效率，更重要的是通过共享表征带来了正则化效果，提升了模型的泛化性能，避免了为每个任务单独训练模型所带来的偏差与复杂性。
严谨的模型训练策略：引入了ReduceLROnPlateau动态学习率调度器，在验证损失进入平台期时自动降低学习率，以精细调优模型参数。集成早停（Early Stopping） 机制，监控验证集性能，在模型即将过拟合前终止训练，获得泛化能力最佳的模型。
上述策略共同构成了一套自动化、智能化的训练协议，降低了对超参数手工调优的依赖，增强了实验的可重复性和鲁棒性。
#  安装

# 前提条件
- Python 3.8+
- PyTorch 1.9+

# 安装步骤

1. 克隆仓库：
```bash
git clone https://github.com/yourusername/building-damage-diagnosis.git
cd building-damage-diagnosis

# 模型架构
系统使用基于 CNN 的多任务学习架构：
特征提取: 1D 卷积网络处理距离和斜率特征

多任务头:
分类头：预测损伤位置（象限）
回归头：预测损伤程度

 性能指标
在测试数据上的典型性能：

位置准确率: >85%

损伤程度 MAE: <0.15

推理速度: 1000+ samples/second (GPU)

 开发者
Chen Yanxuan

 贡献
欢迎提交 Issue 和 Pull Request！对于重大更改，请先开 Issue 讨论您想要更改的内容。

 许可证
本项目采用 MIT 许可证 - 查看 LICENSE 文件了解详情。

致谢
感谢 PyTorch 团队提供的深度学习框架

感谢所有为这个项目提供反馈和建议的贡献者

⭐ 如果这个项目对你有帮助，请给它一个 Star！
